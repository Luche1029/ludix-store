<div class="container">

  <div class="form-group">
    <form (ngSubmit)="save()">
      <h2>{{ 'addresses.add_new_address' | translate}}</h2>
      <div class="line"></div>

      <label *ngIf="user.role === 'ADM' && !state">{{ 'subgroups.group' | translate}}</label>
      <select 
        *ngIf="user.role === 'ADM' && !state"
          [(ngModel)]="filters.group" 
          name="group" 
          (change)="onGroupChange()">
        <option value="">{{ 'orders.all_groups' | translate }}</option>
        <option *ngFor="let g of groups" [value]="g.code">{{ g.name }}</option>
      </select>

      <label *ngIf="['ADM', 'SUP'].includes(user.role) && !state">{{ 'stores.subgroup' | translate}}</label>
      <select 
        *ngIf="['ADM', 'SUP'].includes(user.role) && !state"
        [(ngModel)]="filters.subgroup"
        name="subgroup"
        (change)="onSubgroupChange()">
        <option value="">{{ 'orders.all_subgroups' | translate }}</option>
        <option *ngFor="let sg of subgroups" [value]="sg.code">{{ sg.name }}</option>
      </select>
 
      <label *ngIf="['ADM', 'SUP', 'CAT'].includes(user.role) && !state">{{ 'orders.store' | translate}}</label>
      <select 
        *ngIf="['ADM', 'SUP', 'CAT'].includes(user.role) && !state"
        [(ngModel)]="filters.store"
        name="store"
        (change)="onStoreChange()"
        required>
        <option value="">{{ 'orders.all_stores' | translate }}</option>
        <option *ngFor="let s of stores" [value]="s.store_code">{{ s.name }}</option>
      </select>


      <label>{{ 'addresses.label' | translate}}</label>
      <input type="text" [(ngModel)]="formData.label" name="label" required />

      <label>{{ 'addresses.vat_number' | translate}}</label>
      <input type="text" [(ngModel)]="formData.vat_number" name="vat_number" required />

      <label>{{ 'addresses.referent' | translate}}</label>
      <input type="text" [(ngModel)]="formData.referent" name="referent" required />
      
      <label>{{ 'addresses.address_line_1' | translate}}</label>
      <input type="text" [(ngModel)]="formData.address1" name="address1" required />
      
      <label> {{ 'addresses.address_line_2' | translate}}</label>
      <input type="text" [(ngModel)]="formData.address2" name="address2" />
      
      <label>{{ 'addresses.zip' | translate}}</label>
      <input type="text" [(ngModel)]="formData.zip" name="zip" required />
      
      <label>{{ 'addresses.city' | translate}}</label>
      <input type="text" [(ngModel)]="formData.city" name="city" required />
      
      <label>{{ 'addresses.province' | translate}}</label>
      <input type="text" [(ngModel)]="formData.province" name="province" required />
      
      <label>{{ 'addresses.country' | translate}}</label>
      <input type="text" [(ngModel)]="formData.country" name="country" required />
      
      <label>{{ 'addresses.phone' | translate}}</label>
      <input type="text" [(ngModel)]="formData.phone" name="phone" />
      
      <label>{{ 'addresses.email' | translate}}</label>
      <input type="email" [(ngModel)]="formData.email" name="email" />

      <app-switch 
        label="{{ 'addresses.default_address' | translate}}" 
        [(ngModel)]="formData.isDefault" 
        name="isDefault" >
      </app-switch>

      <div class="row">
        <button type="submit" *ngIf="!state">{{ 'layout.save' | translate}}</button>
        <button type="button" *ngIf="state" (click)="update()">{{ 'layout.save' | translate}}</button>
        <button type="button" (click)="cancel()">{{ 'layout.cancel' | translate}}</button>
      </div>
    </form>
  </div>
</div>
